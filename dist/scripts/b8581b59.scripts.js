(function(){"use strict";angular.module("votacoesCamaraApp",["ngRoute"]).config(["$routeProvider",function(a){return a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/:party_id/:year",{templateUrl:"views/party.html",controller:"PartyCtrl"}).otherwise({redirectTo:"/"})}])}).call(this),function(){"use strict";angular.module("votacoesCamaraApp").controller("MainCtrl",["$scope","parties",function(a,b){return a.parties=b,a.filepaths=["data/matrix-pt-2004.json","data/matrix-pt-2005.json","data/matrix-pt-2006.json","data/matrix-pt-2007.json","data/matrix-psol-2007.json"],a.filepath=a.filepaths[0]}])}.call(this),function(){"use strict";angular.module("votacoesCamaraApp").directive("adjacencyMatrix",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;return c={top:80,right:0,bottom:10,left:130},e=720,b=720,f=d3.scale.ordinal().rangeBands([0,e]),a=d3.scale.quantile().domain([.5,1]).range(["#225ea8","#41b6c4","#a1dab4","#ffffcc","#fed98e","#fe9929","#cc4c02"]),d=function(a,b){return d3.json(b,function(b){var c,d,e,g;return c=[],e=b.nodes,d=e.length,e.forEach(function(a,b){return a.index=b,a.count=0,c[b]=d3.range(d).map(function(a){return{x:a,y:b,z:0}})}),b.links.forEach(function(a){return c[a.source][a.target].z+=a.value,c[a.source][a.source].z+=a.value,c[a.target][a.target].z+=a.value,c[a.source].name=e[a.source].name,e[a.source].count+=a.value,e[a.target].count+=a.value}),g={count:d3.range(d).sort(function(a,b){return e[b].count-e[a].count})},f.domain(g.count),j(a,c)})},j=function(a,b){var c;return c=d3.select(a).select("g"),m(c,b),k(c,b),c.selectAll(".row").each(h)},m=function(a,b){var c;return c=i(a,b,"row",function(a,b){return"translate(0, "+f(b)+")"}),l(c).attr("x",-6).attr("text-anchor","end"),c},k=function(a,b){var c;return c=i(a,b,"column",function(a,b){return"translate("+f(b)+")rotate(-90)"}),l(c).attr("x",6).attr("text-anchor","start"),c},h=function(b){var c;return c=d3.select(this).selectAll(".cell").data(b.filter(function(a){return a.z})),c.enter().append("rect").attr("class","cell"),c.attr("x",function(a){return f(a.x)}).attr("width",f.rangeBand()).attr("height",f.rangeBand()).style("fill",function(b){return a(b.z)}),c.exit().remove()},i=function(a,b,c,d){var e,f;return f=a.selectAll("."+c).data(b,function(a){return a.name}),e=f.enter().append("g").attr("class",c),f.attr("transform",d),f.exit().remove(),e},l=function(a){return a.append("text").attr("y",f.rangeBand()/2).attr("dy",".32em").text(function(a){return a.name})},g=function(){var b,c,d,e,f,g,h,i,j,k,l,m;for(c=a.range(),d=a.domain(),h=d[0],g=d[1],f=c.length,j=(g-h)/f,i=100/f,m=[],e=k=0,l=c.length;l>k;e=++k)b=c[e],m.push({color:b,threshold:h+e*j,width:i});return m},{restrict:"E",templateUrl:"views/directives/adjacencyMatrix.html",scope:{filepath:"="},link:function(a,f){return a.width=e,a.height=b,a.margin=c,a.scales=g(),a.$watch("filepath",function(a){return d(f[0],a)})}}})}.call(this),function(){"use strict";angular.module("votacoesCamaraApp").controller("PartyCtrl",["$scope","$routeParams","parties",function(a,b,c){return a.party=c[b.party_id],a.year=b.year,a.$watch("year",function(b){return a.filepath="data/matrix-"+a.party.id+"-"+b+".json"})}])}.call(this),function(){"use strict";angular.module("votacoesCamaraApp").constant("parties",{pt:{id:"pt",label:"PT",years:["2002","2003","2004","2005","2006","2007"]},pmdb:{id:"pmdb",label:"PMDB",years:["2002","2003","2004","2005","2006","2007"]},psol:{id:"psol",label:"PSOL",years:["2007"]}})}.call(this),function(){"use strict";angular.module("votacoesCamaraApp").filter("percentual",function(){var a;return a=function(a){var b,c;return b=Math.abs(a),c=b>100?0:b>10?1:2,a.toFixed(c).replace(".",",")},function(b){return a(100*b||0)+"%"}})}.call(this);